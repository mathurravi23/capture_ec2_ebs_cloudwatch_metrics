### Pre-requisites Installation

1. Install packages:

pip3 install -r requirements.txt

2. Configure the AWS CLI:

aws configure

### Script Configuration:

This script capture CloudWatch metric for Amazon EC2 and EBS volumes attached to this EC2 instance. Script will generate output csv file with below metrics:

EC2:
- CPUUtilization %Maximum
- CPUUtilization %Average

EBS:
- VolumeReadOpsMaximum
- VolumeReadBytesSum
- VolumeWriteBytesSum
- VolumeOpsSum
- VolumeBytesSum
- IoSize

This script accepts few optional parameters as explained below.


1. Input File (--i or -input_file) - Provide input file for the script. Input file should have only one column with list of EC2 instance Ids without header. By default, when input file is not supplied, script will fetch CloudWatch metrics for all running EC2 instances within the AWS region. Sample input file is attached for your reference.

2. Output File (--o or -output_file) - Provide name for output_file generated by this script. By default, when output file is not specified, script will generate output file named "ebs-ec2-output.csv". Sample output file is attached for your reference.

3. Region (--r or --region) - Specify AWS Region where AWS EC2 instances are located. Default is "us-east-1".

4. Days_Back ( -d or --days_back) - Specify number of days to pull CloudWatch metrics. Default is 30 days (current_time - days_back).


### Script Usage

python3 cloudwatch_for_ec2_ebs.py

usage: cloudwatch_for_ec2_ebs.py [-h] [-i INPUT_FILE] [-o OUTPUT_FILE]
                                 [-r REGION] [-p PROFILE] [-d DAYS_BACK]


![image](https://user-images.githubusercontent.com/82545117/190685860-56be9724-3f90-4d65-ac80-da738a3a1323.png)


Reference : https://gist.github.com/ericg-aws/03c365c98dae5893959907b4b9dbbd27
